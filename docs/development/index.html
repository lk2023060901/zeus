<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>开发指南 - Zeus项目文档</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <a href="../index.html" class="logo">Zeus 项目</a>
            <ul class="nav-links">
                <li><a href="../getting-started/index.html">快速开始</a></li>
                <li><a href="../modules/index.html">模块文档</a></li>
                <li><a href="index.html">开发指南</a></li>
                <li><a href="../api/index.html">API文档</a></li>
            </ul>
        </nav>
    </header>

    <!-- Main Layout -->
    <div class="main-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <h3>开发指南</h3>
            <ul class="sidebar-nav">
                <li><a href="index.html" class="active">概览</a></li>
                <li><a href="project-structure.html">项目结构</a></li>
                <li><a href="coding-standards.html">编码规范</a></li>
                <li><a href="contribution.html">贡献指南</a></li>
                <li><a href="debugging.html">调试指南</a></li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <!-- Breadcrumbs -->
            <nav class="breadcrumb">
                <a href="../index.html">首页</a>
                <span>/</span>
                <span>开发指南</span>
            </nav>

            <h1>开发指南</h1>
            
            <p>欢迎来到Zeus游戏框架开发指南！本指南将帮助您了解游戏框架结构、开发规范、代码风格和贡献流程，让您能够高效地参与Zeus MMORPG游戏框架的开发。</p>

            <!-- Development Environment -->
            <section>
                <h2>开发环境设置</h2>
                
                <div class="card">
                    <h3>推荐开发工具</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>工具类型</th>
                                <th>推荐工具</th>
                                <th>版本要求</th>
                                <th>说明</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>IDE</td>
                                <td>Visual Studio Code, CLion</td>
                                <td>最新版</td>
                                <td>支持C++17和CMake</td>
                            </tr>
                            <tr>
                                <td>编译器</td>
                                <td>GCC, Clang, MSVC</td>
                                <td>7+, 5+, 2017+</td>
                                <td>支持C++17标准</td>
                            </tr>
                            <tr>
                                <td>构建系统</td>
                                <td>CMake</td>
                                <td>3.16+</td>
                                <td>跨平台构建</td>
                            </tr>
                            <tr>
                                <td>版本控制</td>
                                <td>Git</td>
                                <td>2.20+</td>
                                <td>分布式版本控制</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="card">
                    <h3>VS Code开发环境配置</h3>
                    <p>推荐的VS Code扩展：</p>
                    <ul>
                        <li><strong>C/C++</strong> - Microsoft官方C++扩展</li>
                        <li><strong>CMake Tools</strong> - CMake集成</li>
                        <li><strong>clangd</strong> - 代码智能感知</li>
                        <li><strong>GitLens</strong> - Git增强功能</li>
                        <li><strong>Doxygen Documentation Generator</strong> - 文档生成</li>
                    </ul>

                    <p>配置示例 (.vscode/settings.json)：</p>
                    <pre><code>{
    "cmake.buildDirectory": "${workspaceFolder}/build",
    "cmake.generator": "Unix Makefiles",
    "C_Cpp.default.configurationProvider": "ms-vscode.cmake-tools",
    "C_Cpp.default.cppStandard": "c++17",
    "files.associations": {
        "*.h": "cpp",
        "*.hpp": "cpp"
    }
}</code></pre>
                </div>

                <div class="card">
                    <h3>CLion开发环境配置</h3>
                    <p>CLion配置要点：</p>
                    <ul>
                        <li>设置C++17标准</li>
                        <li>配置CMake工具链</li>
                        <li>启用代码格式化</li>
                        <li>配置调试器</li>
                    </ul>

                    <p>CMake配置示例：</p>
                    <pre><code># CLion CMake选项
-DCMAKE_BUILD_TYPE=Debug
-DBUILD_TESTS=ON
-DBUILD_SHARED_LIBS=OFF</code></pre>
                </div>
            </section>

            <!-- Project Structure -->
            <section>
                <h2>项目结构详解</h2>
                
                <div class="card">
                    <h3>目录层次结构</h3>
                    <pre><code>zeus/                           # 项目根目录
├── CMakeLists.txt              # 主CMake配置文件
├── README.md                   # 项目说明文档
├── LICENSE                     # 许可证文件
│
├── include/                    # 公共头文件目录
│   └── common/                 # 公共模块头文件
│       └── spdlog/            # 日志模块头文件
│           ├── zeus_log_manager.h
│           └── logger_config.h
│
├── src/                        # 源代码目录
│   └── common/                 # 公共模块源代码
│       ├── CMakeLists.txt     # Common模块构建配置
│       └── spdlog/            # 日志模块实现
│           ├── zeus_log_manager.cpp
│           └── logger_config.cpp
│
├── tests/                      # 测试代码目录
│   ├── CMakeLists.txt         # 测试构建配置
│   ├── basic/                 # 基础功能测试
│   ├── spdlog_basic/          # 日志基础测试
│   ├── spdlog_performance/    # 性能测试
│   ├── spdlog_config/         # 配置测试
│   └── spdlog_multithread/    # 多线程测试
│
├── docs/                       # 项目文档
│   ├── index.html             # 文档首页
│   ├── css/                   # 样式文件
│   ├── getting-started/       # 快速开始文档
│   ├── modules/               # 模块文档
│   ├── development/           # 开发指南
│   └── api/                   # API文档
│
├── cmake/                      # CMake模块和脚本
│   └── modules/               # 查找第三方库的模块
│       ├── FindSpdlog.cmake
│       ├── FindNlohmannJson.cmake
│       └── FindBoost.cmake
│
├── thirdparty/                # 第三方库目录
│   ├── spdlog-1.15.3/        # spdlog库
│   ├── nlohmann-json-3.12.0/ # JSON库
│   └── boost-1.88.0/         # Boost库
│
└── build/                     # 构建输出目录 (git ignored)
    ├── lib/                   # 编译生成的库文件
    ├── bin/                   # 编译生成的可执行文件
    └── CMakeFiles/           # CMake生成的文件</code></pre>
                </div>

                <div class="card">
                    <h3>文件命名规范</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>文件类型</th>
                                <th>命名规则</th>
                                <th>示例</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>头文件</td>
                                <td>小写字母+下划线，.h扩展名</td>
                                <td>zeus_log_manager.h</td>
                            </tr>
                            <tr>
                                <td>源文件</td>
                                <td>小写字母+下划线，.cpp扩展名</td>
                                <td>zeus_log_manager.cpp</td>
                            </tr>
                            <tr>
                                <td>类名</td>
                                <td>PascalCase命名</td>
                                <td>ZeusLogManager</td>
                            </tr>
                            <tr>
                                <td>函数名</td>
                                <td>PascalCase命名</td>
                                <td>GetLogger, Initialize</td>
                            </tr>
                            <tr>
                                <td>变量名</td>
                                <td>小写字母+下划线</td>
                                <td>config_file, log_level</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Development Workflow -->
            <section>
                <h2>开发工作流程</h2>
                
                <div class="card">
                    <h3>标准开发流程</h3>
                    <ol>
                        <li><strong>环境准备</strong>
                            <pre><code># 克隆项目
git clone &lt;repository-url&gt; zeus
cd zeus

# 创建开发分支
git checkout -b feature/new-feature</code></pre>
                        </li>
                        
                        <li><strong>构建和测试</strong>
                            <pre><code># 创建构建目录
mkdir build && cd build

# 配置项目
cmake .. -DCMAKE_BUILD_TYPE=Debug -DBUILD_TESTS=ON

# 编译项目
make -j$(nproc)

# 运行测试
./bin/zeus_test_basic</code></pre>
                        </li>
                        
                        <li><strong>代码开发</strong>
                            <ul>
                                <li>遵循编码规范</li>
                                <li>编写单元测试</li>
                                <li>添加必要的文档</li>
                                <li>确保代码通过所有测试</li>
                            </ul>
                        </li>
                        
                        <li><strong>提交变更</strong>
                            <pre><code># 添加修改的文件
git add src/ include/ tests/

# 提交变更
git commit -m "Add new logging feature"

# 推送到远程分支
git push origin feature/new-feature</code></pre>
                        </li>
                    </ol>
                </div>

                <div class="card">
                    <h3>Git工作流程</h3>
                    <h4>分支策略</h4>
                    <ul>
                        <li><strong>main</strong> - 主分支，稳定版本</li>
                        <li><strong>develop</strong> - 开发分支，集成新功能</li>
                        <li><strong>feature/*</strong> - 功能分支，开发新功能</li>
                        <li><strong>bugfix/*</strong> - 修复分支，修复bug</li>
                        <li><strong>release/*</strong> - 发布分支，准备发布</li>
                    </ul>

                    <h4>提交信息格式</h4>
                    <pre><code>类型(范围): 简短描述

详细描述 (可选)

相关问题: #123</code></pre>

                    <p>提交类型：</p>
                    <ul>
                        <li><code>feat</code> - 新功能</li>
                        <li><code>fix</code> - 修复bug</li>
                        <li><code>docs</code> - 文档更新</li>
                        <li><code>style</code> - 代码格式化</li>
                        <li><code>refactor</code> - 代码重构</li>
                        <li><code>test</code> - 添加测试</li>
                        <li><code>chore</code> - 构建工具等</li>
                    </ul>
                </div>
            </section>

            <!-- Coding Standards -->
            <section>
                <h2>编码规范</h2>
                
                <div class="card">
                    <h3>C++编码风格</h3>
                    
                    <h4>类定义</h4>
                    <pre><code>// 头文件: zeus_log_manager.h
#pragma once

#include &lt;memory&gt;
#include &lt;string&gt;
#include &lt;spdlog/spdlog.h&gt;

namespace common {
namespace spdlog {

class ZeusLogManager {
public:
    // 公共接口
    static ZeusLogManager& Instance();
    bool Initialize(const std::string& config_file = "");
    std::shared_ptr&lt;::spdlog::logger&gt; GetLogger(const std::string& name);

private:
    // 私有构造函数 (单例模式)
    ZeusLogManager() = default;
    ~ZeusLogManager() = default;
    
    // 禁用拷贝和赋值
    ZeusLogManager(const ZeusLogManager&) = delete;
    ZeusLogManager& operator=(const ZeusLogManager&) = delete;
    
    // 私有成员变量
    std::string config_file_path_;
    bool initialized_ = false;
};

} // namespace spdlog
} // namespace common</code></pre>

                    <h4>函数实现</h4>
                    <pre><code>// 源文件: zeus_log_manager.cpp
#include "common/spdlog/zeus_log_manager.h"
#include &lt;iostream&gt;
#include &lt;filesystem&gt;

namespace common {
namespace spdlog {

ZeusLogManager& ZeusLogManager::Instance() {
    static ZeusLogManager instance;
    return instance;
}

bool ZeusLogManager::Initialize(const std::string& config_file) {
    // 参数验证
    if (config_file.empty()) {
        std::cerr << "配置文件路径为空" << std::endl;
        return false;
    }
    
    // 检查文件是否存在
    if (!std::filesystem::exists(config_file)) {
        std::cerr << "配置文件不存在: " << config_file << std::endl;
        return false;
    }
    
    try {
        // 执行初始化逻辑
        config_file_path_ = config_file;
        initialized_ = true;
        return true;
    } catch (const std::exception& e) {
        std::cerr << "初始化失败: " << e.what() << std::endl;
        return false;
    }
}

} // namespace spdlog  
} // namespace common</code></pre>
                </div>

                <div class="card">
                    <h3>注释和文档</h3>
                    
                    <h4>Doxygen文档注释</h4>
                    <pre><code>/**
 * @brief Zeus日志管理器
 * 
 * 提供日志系统的统一管理接口，支持多Logger配置和管理。
 * 采用单例模式设计，确保全局唯一的日志管理实例。
 * 
 * @author Zeus Team
 * @version 1.0.0
 * @date 2025-08-12
 */
class ZeusLogManager {
public:
    /**
     * @brief 获取日志管理器单例实例
     * 
     * @return ZeusLogManager& 日志管理器实例引用
     */
    static ZeusLogManager& Instance();
    
    /**
     * @brief 初始化日志系统
     * 
     * @param config_file 配置文件路径，为空时使用默认配置
     * @return true 初始化成功
     * @return false 初始化失败
     */
    bool Initialize(const std::string& config_file = "");
};</code></pre>

                    <h4>行内注释</h4>
                    <pre><code>bool ZeusLogManager::Initialize(const std::string& config_file) {
    // 检查是否已经初始化
    if (initialized_) {
        return true;
    }
    
    // 使用默认配置文件路径
    std::string actual_config = config_file.empty() ? 
        "log_config.json" : config_file;
    
    // 验证配置文件存在性
    if (!std::filesystem::exists(actual_config)) {
        // TODO: 考虑创建默认配置文件
        return false;
    }
    
    return true;
}</code></pre>
                </div>
            </section>

            <!-- Testing Guidelines -->
            <section>
                <h2>测试指南</h2>
                
                <div class="card">
                    <h3>测试架构</h3>
                    <p>Zeus项目采用模块化的测试架构，每个测试都有独立的目录和配置：</p>
                    <pre><code>tests/
├── CMakeLists.txt              # 测试管理配置
├── basic/                      # 基础功能测试
│   ├── CMakeLists.txt
│   ├── test_basic.cpp
│   └── log_config.json
├── spdlog_basic/              # 日志基础测试
├── spdlog_performance/        # 性能基准测试
├── spdlog_config/             # 配置功能测试
└── spdlog_multithread/        # 多线程安全测试</code></pre>
                </div>

                <div class="card">
                    <h3>编写新测试</h3>
                    <ol>
                        <li><strong>创建测试目录</strong>
                            <pre><code># 创建新测试目录
mkdir tests/new_feature_test
cd tests/new_feature_test</code></pre>
                        </li>
                        
                        <li><strong>编写CMakeLists.txt</strong>
                            <pre><code># tests/new_feature_test/CMakeLists.txt
add_executable(test_new_feature test_new_feature.cpp)
target_link_libraries(test_new_feature PRIVATE common_spdlog)
target_include_directories(test_new_feature PRIVATE 
    ${CMAKE_SOURCE_DIR}/include
)</code></pre>
                        </li>
                        
                        <li><strong>编写测试代码</strong>
                            <pre><code>// tests/new_feature_test/test_new_feature.cpp
#include "common/spdlog/zeus_log_manager.h"
#include &lt;iostream&gt;

int main() {
    using namespace common::spdlog;
    
    std::cout << "开始新功能测试..." << std::endl;
    
    // 初始化日志系统
    if (!ZeusLogManager::Instance().Initialize("log_config.json")) {
        std::cerr << "日志初始化失败" << std::endl;
        return 1;
    }
    
    // 测试新功能
    auto logger = ZeusLogManager::Instance().GetLogger("test");
    logger->info("新功能测试开始");
    
    // 添加具体的测试逻辑
    
    logger->info("新功能测试完成");
    std::cout << "新功能测试通过！" << std::endl;
    
    return 0;
}</code></pre>
                        </li>
                        
                        <li><strong>添加配置文件</strong>
                            <pre><code># tests/new_feature_test/log_config.json
{
  "loggers": [
    {
      "name": "test",
      "level": "debug",
      "rotation_type": "daily",
      "file_path": "logs/test.log",
      "max_files": 7
    }
  ]
}</code></pre>
                        </li>
                        
                        <li><strong>更新主测试配置</strong>
                            <pre><code># 在 tests/CMakeLists.txt 中添加
add_subdirectory(new_feature_test)</code></pre>
                        </li>
                    </ol>
                </div>
            </section>

            <!-- Debugging -->
            <section>
                <h2>调试指南</h2>
                
                <div class="card">
                    <h3>调试构建配置</h3>
                    <pre><code># 创建调试构建
mkdir debug_build && cd debug_build

# 配置调试模式
cmake .. \
  -DCMAKE_BUILD_TYPE=Debug \
  -DBUILD_TESTS=ON \
  -DCMAKE_CXX_FLAGS="-g -O0"

# 编译
make -j$(nproc)</code></pre>
                </div>

                <div class="card">
                    <h3>GDB调试</h3>
                    <pre><code># 启动GDB调试
gdb ./bin/zeus_test_basic

# 设置断点
(gdb) break zeus_log_manager.cpp:25
(gdb) break ZeusLogManager::Initialize

# 运行程序
(gdb) run

# 查看变量
(gdb) print config_file
(gdb) info locals

# 查看调用栈
(gdb) backtrace</code></pre>
                </div>

                <div class="card">
                    <h3>内存检查</h3>
                    <pre><code># 使用Valgrind检查内存泄漏
valgrind --leak-check=full --show-leak-kinds=all ./bin/zeus_test_basic

# 使用AddressSanitizer
cmake .. -DCMAKE_CXX_FLAGS="-fsanitize=address -g"
make && ./bin/zeus_test_basic</code></pre>
                </div>
            </section>

            <!-- Performance Optimization -->
            <section>
                <h2>性能优化</h2>
                
                <div class="card">
                    <h3>编译优化</h3>
                    <pre><code># Release构建
cmake .. -DCMAKE_BUILD_TYPE=Release

# 启用链接时优化 (LTO)
cmake .. \
  -DCMAKE_BUILD_TYPE=Release \
  -DCMAKE_INTERPROCEDURAL_OPTIMIZATION=ON

# 原生CPU优化
cmake .. \
  -DCMAKE_BUILD_TYPE=Release \
  -DCMAKE_CXX_FLAGS="-march=native"</code></pre>
                </div>

                <div class="card">
                    <h3>性能测量</h3>
                    <pre><code># 运行性能测试
./bin/test_spdlog_performance

# 使用perf分析 (Linux)
perf record ./bin/test_spdlog_performance
perf report

# CPU使用率监控
top -p $(pgrep test_spdlog_performance)</code></pre>
                </div>
            </section>

            <!-- Navigation -->
            <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border-color); display: flex; justify-content: space-between;">
                <a href="../modules/index.html" class="btn btn-secondary">← 模块文档</a>
                <a href="project-structure.html" class="btn">项目结构 →</a>
            </div>
        </main>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div>
                <p>&copy; 2025 Zeus项目. 基于C++17开发的大型MMORPG游戏框架，支持分布式部署。</p>
            </div>
            <ul class="footer-nav">
                <li><a href="../index.html">首页</a></li>
                <li><a href="../getting-started/index.html">快速开始</a></li>
                <li><a href="../modules/index.html">模块文档</a></li>
                <li><a href="index.html">开发指南</a></li>
            </ul>
        </div>
    </footer>
</body>
</html>